\chapter{Изучение и анализ возможности переезда и опыта других компаний} \label{ch:ch1}
Непосредственно перед самим переездом стоит понять насколько эта задача выполнима.
Кроме того, несмотря на любовь программистов изобретать велосипеды,
первоначально стоит ознакомиться с готовыми решениями, а также с опытом других компаний,
которые уже осуществляли подобный перенос.
С них и стоит начать.


\section{Опыт других компаний}\label{sec:other-companies-expirience}
Изучив доступные материалы по переезду компаний на GitLab,
наблюдается интересная картина: подробным опытом миграции целой компании поделился преимущественно ecom.tech (Samokat),
в то время как большинство других ресурсов ограничиваются описанием базовых принципов переноса репозиториев.

Однако начальные условия у Самоката были другие.
Они использовали три разрозненных GitLab, в которых хоть и по-разному, но уже были описаны шаблоны на языке платформы.
Из интересного — компания показала свой план миграции, в котором также фигурирует стандартизация CI/CD шаблонов.
Как они это будут делать — не рассказали, однако дали свою оценку для переноса 500 репозиториев, что сопоставимо с количеством в Mindbox.
Основная же часть доклада посвящена способам воссоздания функциональных возможностей платной версии GitLab, потому что
Самокат не может приобрести лицензию.
К сожалению, эта часть доклада не оказалась полезной,
ввиду того, что представленные Самокатом способы ухудшают опыт использования разработчиками по сравнению с GitHub,
что является не допустимо для Mindbox.
Кроме того, компания может позволить себе приобрести платную лицензию.

Отдельно стоит отметить статью \enquote{Импортозамещение облаков: как настроить GitLab Runner в Yandex Cloud и не обанкротиться}.
В отличие от GitHub GitLab подразумевает настройку машин, на которых будет запускаться пайплайн.
Mindbox в своей инфраструктуре активно использует Yandex Cloud, поэтому, и хоть в данном отчете и не будет описана организация машин-исполнителей,
текст статьи оказался очень полезным.

\section{Существующие решения}\label{sec:existing-solutions}
\subsection{Официальные инструменты} \label{subsec:official-migration-instruments}
Далее будут разобраны существующие решения по переносу, которые были описаны во множестве статей.

GitLab имеет встроенный инструмент переноса репозиториев из других сервисов,
который полностью переносит коммиты, пользователей, ветки, заметки, а также частично настройки репозиториев.
Хоть эта разработка и облегчает перенос, она все же имеет ряд критических ограничений:
\begin{itemize}
  \item Не умеет транслировать CI/CD шаблоны GitHub Actions в GitLab Pipelines;
  \item Не переносит многие настройки из GitHub: политики доступа, правила слияния и т.д.
\end{itemize}
Тем не менее как отправная точка инструмент неплохо себя зарекомендовал, его было принято взять за основу решения для Mindbox.

\subsection{Сторонние решения} \label{subsec:third-party-migration-instruments}
Так как GitLab не предоставляет встроенные инструменты трансляции CI/CD шаблонов, стоит поискать сторонние.
\texttt{gh-actions-importer}\cite{gh-actions-migrator} — единственный публичный и поддерживаемый инструмент, работающий с GitHub и GitLab.
Он способен частично транслировать конфигурации конвейеров, но, только в одном направлении (GitLab CI/CD $\rightarrow$ GitHub Actions),
что не соответствует требованиям компании.
Кроме того, код логики инструмента недоступен, что делает его непригодным для адаптации под нужды компании.

\section{Возможные причины отсутствия инструментов} \label{sec:instrument-absence}
К сожалению, в ходе исследования не удалось найти опыт других крупных компаний, связанных с переносом репозиториев и CI/CD шаблонов на GitLab.
Подобная ситуация может быть обусловлена следующими факторами:
\begin{enumerate}
  \item Многие компании, которым важно было иметь self-hosted решение и полный контроль над своим кодом, используют GitLab с самого начала.
        Соответственно, нужды переезда у них не возникало.

  \item Массовая миграция между GitHub и GitLab обычно вызвана внешними факторами: санкции, смена стратегии компании.
        Это не формирует устойчивого спроса на универсальные решения.
        При этом сам сервис GitLab не предоставляет инструмента для миграции CI/CD, что усложняет задачу.

  \item Конфигурации CI/CD в компаниях часто существенно различаются и могут использовать разные подходы,
        механики и параметры, а также сторонние интеграции.
        Создание универсального инструмента, подходящего для нескольких корпораций, крайне затруднительно.

  \item После успешного перехода компании не заинтересованы в поддержке инструмента в силу единоразовости перехода.
        Это подтверждается отсутствием открытых решений от других компаний.
\end{enumerate}
